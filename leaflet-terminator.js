!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.terminator=n()}(this,function(){"use strict";var o={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function c(t){return t*(Math.PI/180)}function f(t){return t*(180/Math.PI)}var i=function(t,n,a,e){var r=c(n),s=a/o.RADIUS,i=c(t[0]),h=c(t[1]),u=Math.asin(Math.sin(h)*Math.cos(s)+Math.cos(h)*Math.sin(s)*Math.cos(r)),M=Math.atan2(Math.sin(r)*Math.sin(s)*Math.cos(h),Math.cos(s)-Math.sin(h)*Math.sin(u));return[f(e?(i-M+Math.PI)%(2*Math.PI)-Math.PI:i-M+Math.PI-Math.PI),f(u)]};var n=function(n,r,t){n=L.latLng(n);var s=(t=t||{}).parts||20;function a(t){for(var n=[],a=r/o.RADIUS*180/Math.PI,e=0;e<s+1;e++)n.push(i([t.lng,t.lat],e/s*360,r).reverse());return a>90-t.lat&&n.push([n[0][0],t.lng+180],[90,t.lng+180],[90,t.lng-180],[n[0][0],t.lng-180]),a>90+t.lat&&n.splice(1+(s>>1),0,[n[s>>1][0],t.lng-180],[-90,t.lng-180],[-90,t.lng+180],[n[s>>1][0],t.lng+180]),n}var e=L.polygon(a(n),t);return e.setLatLng=function(t){return n=t,e.setLatLngs(a(n)),e},e.getRadius=function(t){return r},e.setRadius=function(t){return r=t,e.setLatLngs(a(n)),e},e},a=Math.PI,v=a/180,p=180/a;function d(t){return(357.52911+t*(35999.05029-1537e-7*t))*v}function D(t){var n=(280.46646+t*(36000.76983+3032e-7*t))%360;return(n<0?n+360:n)/180*a}function P(t){return(23+(26+(21.448-(n=t)*(46.815+n*(59e-5-.001813*n)))/60)/60)*v+.00256*Math.cos((125.04-1934.136*t)*v)*v;var n}return function(t){var I=n([0,0],6378137*a/2,{parts:100});return I.setDate=function(t){var n,a,e,r,s,i,h,u,M,o,c,f,g,l;return I.setLatLng(L.latLng((a=t,e=(a-Date.UTC(2e3,0,1,12))/864e5/36525,n=[(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-a)/864e5*360-180-(M=e,l=M,o=.016708634-l*(42037e-9+1.267e-7*l),c=d(M),f=D(M),g=Math.tan(P(M)/2),((g*=g)*Math.sin(2*f)-2*o*Math.sin(c)+4*o*g*Math.sin(c)*Math.cos(2*f)-.5*g*g*Math.sin(4*f)-1.25*o*o*Math.sin(2*c))*p),(r=e,Math.asin(Math.sin(P(r))*Math.sin((s=r,i=s,D(i)+(h=i,u=d(h),(Math.sin(u)*(1.914602-h*(.004817+14e-6*h))+Math.sin(u+u)*(.019993-101e-6*h)+289e-6*Math.sin(u+u+u))*v)-(.00569+.00478*Math.sin((125.04-1934.136*s)*v))*v)))*p)],[n[0]+180,-n[1]]).reverse()).wrap()),I},I.setDate(t||new Date)}});
